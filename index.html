<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>éº‹é¹¿æ€§åå¥½å…¨ç»´æµ‹è¯•</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #5b8ff9; /* éº‹é¹¿è“ */
            --bg-color: #f0f2f5; /* ç½‘é¡µèƒŒæ™¯ç° */
            --card-bg: #ffffff;  /* å¡ç‰‡ç™½ */
            --text-main: #333;
            --text-sub: #888;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* ç¦æ­¢èƒŒæ™¯æ»šåŠ¨ */
        }

        /* å¡ç‰‡å®¹å™¨ï¼šæ‚¬æµ®è®¾è®¡ */
        .container {
            background: var(--card-bg);
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            
            /* å°ºå¯¸è‡ªé€‚åº”ï¼šå å±å¹•90% */
            width: 90%; 
            max-width: 420px; 
            height: 90vh; 
            max-height: 800px; 
            
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden; 
        }

        /* å†…éƒ¨æ»šåŠ¨åŒºåŸŸ */
        .page-content {
            flex: 1;
            padding: 30px 24px;
            overflow-y: auto; /* å…è®¸å¡ç‰‡å†…éƒ¨æ»šåŠ¨ */
            display: flex;
            flex-direction: column;
            /* éšè—æ»šåŠ¨æ¡ */
            scrollbar-width: none; 
            -ms-overflow-style: none;
        }
        .page-content::-webkit-scrollbar { display: none; }

        /* 1. é¦–é¡µæ ·å¼ */
        .intro-box { text-align: center; justify-content: center; }
        .intro-logo { font-size: 64px; margin-bottom: 20px; animation: float 3s ease-in-out infinite; }
        h1 { font-size: 24px; font-weight: bold; color: #333; margin-bottom: 16px; }
        .intro-desc { font-size: 15px; color: #666; line-height: 1.8; margin-bottom: 40px; }

        /* 2. ç­”é¢˜é¡µæ ·å¼ */
        .progress-bar-bg {
            width: 100%; height: 6px; background: #f0f0f0; border-radius: 3px; margin-bottom: 30px; flex-shrink: 0;
        }
        .progress-bar-fill {
            height: 100%; background: var(--primary); width: 0%; transition: width 0.3s ease; border-radius: 3px;
        }

        .question-text {
            font-size: 19px; font-weight: bold; margin-bottom: 30px; line-height: 1.5; color: #222; min-height: 60px;
        }

        .options-list { display: flex; flex-direction: column; gap: 14px; }
        .option-item {
            background: #f7f8fa;
            color: #333;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            border: 1px solid transparent;
        }
        .option-item:active { 
            background: #eef4ff; 
            color: var(--primary); 
            border-color: var(--primary);
            transform: scale(0.99);
        }

        /* 3. ç»“æœé¡µæ ·å¼ */
        .result-area { align-items: center; padding-top: 20px; }
        .result-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #333; }
        
        /* æ ¸å¿ƒæ ‡ç­¾ */
        .core-tag {
            background: #e6f7ff; color: var(--primary);
            padding: 8px 20px; border-radius: 8px; font-size: 16px; font-weight: bold;
            margin-bottom: 12px;
        }
        
        /* å‰¯æ ‡ç­¾åŒºåŸŸ */
        .sub-tags-box {
            display: flex; gap: 8px; flex-wrap: wrap; justify-content: center;
            margin-bottom: 10px; min-height: 24px;
        }
        .sub-tag {
            font-size: 12px; color: #666; background: #f5f5f5; 
            padding: 4px 10px; border-radius: 4px;
        }

        .chart-wrapper {
            position: relative;
            width: 100%;
            height: 340px; 
            flex-shrink: 0; 
            margin: 10px 0;
        }

        .save-tip { font-size: 12px; color: #999; margin-bottom: 15px; flex-shrink: 0; }
        
        .result-desc {
            font-size: 14px; color: #555; text-align: justify;
            background: #f9f9f9; padding: 16px; border-radius: 12px;
            margin-bottom: 20px; line-height: 1.6; width: 100%;
        }

        /* åº•éƒ¨æŒ‰é’®åŒºåŸŸ */
        .btn-area { margin-top: auto; width: 100%; padding-top: 10px; }
        .btn {
            background: linear-gradient(135deg, #5b8ff9, #4a7dff);
            color: white;
            border: none;
            padding: 15px 0;
            width: 100%;
            font-size: 16px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 6px 16px rgba(91, 143, 249, 0.3);
            transition: opacity 0.2s;
        }
        .btn:active { opacity: 0.9; transform: scale(0.98); }

        .hidden { display: none !important; }
        
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
    </style>
</head>
<body>

<div class="container">
    
    <div id="page-intro" class="page-content intro-box">
        <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center;">
            <div class="intro-logo">ğŸ¦Œ</div>
            <h1>æ€§åå¥½å…¨ç»´æµ‹è¯•</h1>
            <p class="intro-desc">
                åŸºäº22ä¸ªå¿ƒç†ç»´åº¦<br>
                æ·±åº¦è§£æä½ çš„æ½œåœ¨æ¬²æœ›<br>
                ç”Ÿæˆä¸“å±å…­è¾¹å½¢æˆ˜å£«é›·è¾¾å›¾
            </p>
        </div>
        <div class="btn-area">
            <button class="btn" onclick="startQuiz()">å¼€å§‹æµ‹è¯•</button>
        </div>
    </div>

    <div id="page-quiz" class="page-content hidden">
        <div class="progress-bar-bg"><div class="progress-bar-fill" id="progress"></div></div>
        
        <div class="question-text" id="q-text">é¢˜ç›®åŠ è½½ä¸­...</div>
        
        <div class="options-list" id="opt-list">
            </div>
    </div>

    <div id="page-result" class="page-content hidden result-area">
        <div class="result-title">æµ‹è¯•ç»“æœ</div>
        
        <div class="core-tag" id="core-attr">åˆ†æä¸­...</div>
        
        <div class="sub-tags-box" id="sub-tags"></div>
        
        <div class="chart-wrapper">
            <canvas id="radarChart"></canvas>
        </div>

        <p class="save-tip">é•¿æŒ‰å›¾ç‰‡å¯ä¿å­˜ç»“æœ</p>

        <div class="result-desc" id="result-text">
            æ­£åœ¨ç”Ÿæˆåˆ†æ...
        </div>

        <div class="btn-area">
            <button class="btn" onclick="location.reload()">å†æµ‹ä¸€æ¬¡</button>
        </div>
    </div>

</div>

<script>
    // --- 1. é…ç½®æ•°æ® ---
    // 22ä¸ªç»´åº¦ (é¡ºåºå¯¹åº”é›·è¾¾å›¾é¡ºæ—¶é’ˆ)
    const dimKeys = [
        'sadism', 'humiliation_s', 'conquest', 'control', 'force_s', 
        'protect', 
        'masochism', 'humiliation_m', 'submission', 'obedience', 'force_m', 
        'rebel', 'indulge', 'exhibit', 'group', 'trans', 'gay', 'fetish', 'ntr', 'pure', 'guide', 'mood'
    ];
    
    // ç»´åº¦ä¸­æ–‡å±•ç¤ºå
    const dimLabels = [
        'è™å¾…', 'ç¾è¾±', 'å¾æœ', 'æ§åˆ¶', 'å¼ºè¿«',
        'ä¿æŠ¤',
        'å—è™', 'å±ˆè¾±', 'è‡£æœ', 'æœä»', 'è¢«è¿«',
        'å›é€†', 'æ”¾çºµ', 'æš´éœ²', 'ç¾¤ä½“', 'è·¨æ€§', 'åŒæ€§', 'æ‹ç‰©', 'NTR', 'çº¯çˆ±', 'è¯±å¯¼', 'æƒ…è°ƒ'
    ];

    let scores = {};
    
    // 22é“é¢˜ç›®
    const questions = [
        { t: "1. çœ‹åˆ°ä¼´ä¾£å› ç–¼ç—›è€Œæ‰­æ›²çš„è¡¨æƒ…ï¼Œæˆ‘ä¼šæ„Ÿåˆ°å…´å¥‹ã€‚", k: 'sadism' },
        { t: "2. æˆ‘å–œæ¬¢ç”¨è¨€è¯­è´¬ä½å¯¹æ–¹ï¼Œçœ‹å¯¹æ–¹ç¾è€»çš„æ ·å­ã€‚", k: 'humiliation_s' },
        { t: "3. å½»åº•å‡»å®å¯¹æ–¹çš„å¿ƒç†é˜²çº¿è®©æˆ‘å¾ˆæœ‰æˆå°±æ„Ÿã€‚", k: 'conquest' },
        { t: "4. æˆ‘éœ€è¦å¯¹æ–¹å®Œå…¨æŒ‰ç…§æˆ‘çš„è§„çŸ©å’ŒèŠ‚å¥è¡Œäº‹ã€‚", k: 'control' },
        { t: "5. å–œæ¬¢æ‰®æ¼”â€˜éœ¸ç‹ç¡¬ä¸Šå¼“â€™çš„è§’è‰²ï¼Œæ— è§†å¯¹æ–¹çš„æ‹’ç»ã€‚", k: 'force_s' },
        { t: "6. æˆ‘äº«å—åƒé•¿è¾ˆä¸€æ ·å® æººã€ä¿æŠ¤å¹¶ç®¡æ•™å¯¹æ–¹ã€‚", k: 'protect' },
        { t: "7. èº«ä½“ä¸Šçš„ç–¼ç—›èƒ½è®©æˆ‘æ›´æŠ•å…¥ï¼Œç”šè‡³äº§ç”Ÿå¿«æ„Ÿã€‚", k: 'masochism' },
        { t: "8. è¢«å½“ä½œç‰©å“æˆ–åŠ¨ç‰©å¯¹å¾…ï¼ˆéäººåŒ–ï¼‰è®©æˆ‘å…´å¥‹ã€‚", k: 'humiliation_m' },
        { t: "9. æˆ‘æ¸´æœ›æŠŠè‡ªå·±å®Œå…¨äº¤å‡ºå»ï¼Œä¸å†æ€è€ƒå’Œè´Ÿè´£ã€‚", k: 'submission' },
        { t: "10. æ— è®ºå‘½ä»¤å¤šä¹ˆè¿‡åˆ†ï¼Œå®Œæˆå‘½ä»¤çš„è¿‡ç¨‹è®©æˆ‘æ»¡è¶³ã€‚", k: 'obedience' },
        { t: "11. å¹»æƒ³åœ¨æ— æ³•åæŠ—çš„æƒ…å†µä¸‹è¢«å¼ºè¡Œå æœ‰ã€‚", k: 'force_m' },
        { t: "12. è¶Šæ˜¯è¢«ç¦æ­¢ã€èƒŒå¾·çš„è¡Œä¸ºï¼Œè¶Šèƒ½æ¿€å‘æˆ‘çš„æ¬²æœ›ã€‚", k: 'rebel' },
        { t: "13. åœ¨æ€§çˆ±ä¸­ï¼Œæˆ‘å¸Œæœ›æŠ›å¼ƒç†æ™ºï¼Œåƒé‡å…½ä¸€æ ·æ”¾çºµã€‚", k: 'indulge' },
        { t: "14. æ›¾åœ¨æˆ·å¤–ã€é˜³å°ç­‰åŠå…¬å¼€åœºåˆå°è¯•æˆ–å¹»æƒ³è¿‡äº²çƒ­ã€‚", k: 'exhibit' },
        { t: "15. å¯¹å¤šäººè¿åŠ¨ï¼ˆ3P/ç¾¤Pï¼‰æ„Ÿåˆ°å¥½å¥‡æˆ–å‘å¾€ã€‚", k: 'group' },
        { t: "16. å¯¹æ”¹å˜æ€§åˆ«è§’è‰²çš„è£…æ‰®æˆ–ç©æ³•ï¼ˆå¦‚CD/TSï¼‰æ„Ÿå…´è¶£ã€‚", k: 'trans' },
        { t: "17. è™½æ˜¯ç›´äººï¼Œä½†å¯¹åŒæ€§äº’åŠ¨ä¸æ’æ–¥ç”šè‡³è§‰å¾—åˆºæ¿€ã€‚", k: 'gay' },
        { t: "18. å¯¹ç‰¹å®šç‰©å“ï¼ˆè¶³/ä¸è¢œ/èƒ¶è¡£ç­‰ï¼‰æœ‰å¼ºçƒˆçš„æ€§å†²åŠ¨ã€‚", k: 'fetish' },
        { t: "19. å¹»æƒ³ä¼´ä¾£å’Œä»–äººäº²çƒ­ï¼ˆç»¿å¸½æƒ…èŠ‚ï¼‰è®©æˆ‘å…´å¥‹ã€‚", k: 'ntr' },
        { t: "20. æˆ‘è®¤ä¸ºæ€§å¿…é¡»åŸºäºçˆ±ï¼Œæ— æ³•æ¥å—æ— æ„Ÿæƒ…çš„æ€§ã€‚", k: 'pure' },
        { t: "21. å–œæ¬¢ä¸€æ­¥æ­¥å¼€å‘ä¼´ä¾£ï¼Œæ•™å¯¼å¯¹æ–¹æ‰“å¼€æ–°ä¸–ç•Œã€‚", k: 'guide' },
        { t: "22. ç¯å¢ƒã€ç¯å…‰å’Œæ°”å‘³æ¯”å•çº¯çš„æ´»å¡è¿åŠ¨æ›´é‡è¦ã€‚", k: 'mood' }
    ];

    // é€‰é¡¹ (äº”çº§é‡è¡¨)
    const optionsData = [
        { text: "éå¸¸ä¸ç¬¦åˆ", score: 0 },
        { text: "æ¯”è¾ƒä¸ç¬¦åˆ", score: 1 },
        { text: "ä¸€èˆ¬", score: 2 },
        { text: "æ¯”è¾ƒç¬¦åˆ", score: 3 },
        { text: "éå¸¸ç¬¦åˆ", score: 4 }
    ];

    let currentIdx = 0;

    // --- 2. æ§åˆ¶é€»è¾‘ ---
    function startQuiz() {
        // é‡ç½®
        dimKeys.forEach(k => scores[k] = 0);
        currentIdx = 0;
        
        document.getElementById('page-intro').classList.add('hidden');
        document.getElementById('page-quiz').classList.remove('hidden');
        renderQuestion();
    }

    function renderQuestion() {
        const q = questions[currentIdx];
        document.getElementById('q-text').innerText = q.t;
        
        const percent = ((currentIdx) / questions.length) * 100;
        document.getElementById('progress').style.width = percent + '%';

        const list = document.getElementById('opt-list');
        list.innerHTML = '';
        
        optionsData.forEach(opt => {
            const div = document.createElement('div');
            div.className = 'option-item';
            div.innerText = opt.text;
            // è§£å†³ç§»åŠ¨ç«¯ç‚¹å‡»å»¶è¿Ÿ
            div.onclick = function() {
                scores[q.k] = opt.score;
                // çŸ­æš‚å»¶è¿Ÿè®©ç”¨æˆ·çœ‹åˆ°ç‚¹å‡»æ•ˆæœ
                setTimeout(nextQuestion, 150);
            };
            list.appendChild(div);
        });
    }

    function nextQuestion() {
        currentIdx++;
        if (currentIdx < questions.length) {
            renderQuestion();
        } else {
            calculateAndShowResult();
        }
    }

    // --- 3. æ ¸å¿ƒï¼šæ–°çš„ç»“æœè®¡ç®—é€»è¾‘ ---
    function calculateAndShowResult() {
        document.getElementById('page-quiz').classList.add('hidden');
        document.getElementById('page-result').classList.remove('hidden');

        // A. å°†åˆ†æ•°æ•´ç†ä¸ºæ•°ç»„å¹¶æ’åº: [{key:'sadism', score:4}, ...]
        let sortedScores = dimKeys.map(k => ({ key: k, score: scores[k] }));
        sortedScores.sort((a, b) => b.score - a.score); // é™åº

        let maxScore = sortedScores[0].score;
        let totalScore = sortedScores.reduce((sum, item) => sum + item.score, 0);

        let finalTitle = "";
        let finalDesc = "";
        let subTagsHTML = ""; 

        // B. ç‰¹æ®Šæ¨¡å¼åˆ¤å®š
        // 1. è´¤è€…æ¨¡å¼ (æœ€é«˜åˆ†åªæœ‰0æˆ–1)
        if (maxScore <= 1) {
            finalTitle = "è´¤è€…æ¨¡å¼";
            finalDesc = "ä½ å†…å¿ƒå¹³é™å¦‚æ°´ï¼Œå¯¹ç›®å‰åˆ—å‡ºçš„å„ç§ç‰¹æ®Šç©æ³•éƒ½æ²¡æœ‰æ˜æ˜¾çš„ä¸–ä¿—æ¬²æœ›ã€‚ä½ å¯èƒ½æ­£å¤„äºè´¤è€…æ—¶é—´ï¼Œæˆ–è€…æ¯”èµ·æ„Ÿå®˜åˆºæ¿€ï¼Œæ›´çœ‹é‡çº¯ç²¹çš„ç²¾ç¥äº¤æµã€‚";
        } 
        // 2. æ¬²æœ›é­”ç¥ (æ€»åˆ†æé«˜ï¼Œè¯´æ˜å¤§éƒ¨åˆ†éƒ½é€‰äº†éå¸¸ç¬¦åˆ)
        else if (totalScore >= (questions.length * 3.5)) { 
            finalTitle = "æ¬²æœ›é›†åˆä½“";
            finalDesc = "ä½ çš„æ¥å—åº¦æé«˜ï¼Œå‡ ä¹å¯¹æ‰€æœ‰ç©æ³•éƒ½å……æ»¡äº†å¥½å¥‡ä¸æ¸´æœ›ã€‚ä¼ ç»Ÿçš„å•ä¸€æ ‡ç­¾å·²ç»æ— æ³•å®šä¹‰ä½ ï¼Œä½ å°±åƒæ··æ²Œé˜µè¥çš„é­”ç¥ï¼Œæ¢ç´¢æ¬²æ²¡æœ‰è¾¹ç•Œã€‚";
        }
        // 3. æ­£å¸¸åˆ¤å®š (å–ç¬¬ä¸€å)
        else {
            let top1Key = sortedScores[0].key;
            
            // ç»“æœæ–‡æ¡ˆåº“
            const resultMap = {
                'sadism': { t: 'æ–½è™è€… (S)', d: 'ä½ äº«å—æŒæ§ä¸å¾æœï¼Œçœ‹ç€ä¼´ä¾£åœ¨ä½ çš„å¼•å¯¼ä¸‹å±•éœ²è„†å¼±ï¼Œèƒ½å¸¦ç»™ä½ æ— ä¸ä¼¦æ¯”çš„æ»¡è¶³æ„Ÿã€‚' },
                'humiliation_s': { t: 'è¨€è¯­æ”¯é…è€…', d: 'è¯­è¨€æ˜¯ä½ çš„æ­¦å™¨ï¼Œä½ å–„äºé€šè¿‡è¨€è¯­çš„åŠ›é‡æ‘§æ¯é˜²çº¿ï¼Œé‡å»ºç§©åºã€‚' },
                'conquest': { t: 'å¾æœè€…', d: 'ä½ æ¸´æœ›çš„ä¸æ˜¯é¡ºä»ï¼Œè€Œæ˜¯ç»è¿‡æŠµæŠ—åçš„è‡£æœï¼Œè¿™ç§å¾æœçš„è¿‡ç¨‹è®©ä½ ç€è¿·ã€‚' },
                'control': { t: 'æŒæ§è€…', d: 'ç»†èŠ‚å†³å®šæˆè´¥ï¼Œä½ éœ€è¦åœ¨å…³ç³»ä¸­æ‹¥æœ‰ç»å¯¹çš„çŸ¥æƒ…æƒå’Œå†³å®šæƒã€‚' },
                'force_s': { t: 'å¼ºåŠ›æ”¯é…', d: 'ä½ å€¾å‘äºå±•ç°ç»å¯¹çš„åŠ›é‡ï¼Œè¿™ç§ä¸å¯æŠ—æ‹’çš„å‹è¿«æ„Ÿæ˜¯ä½ æ¬²æœ›çš„æºæ³‰ã€‚' },
                'protect': { t: 'å®ˆæŠ¤è€…', d: 'ä½ çš„æ”¯é…å¸¦æœ‰æ¸©æƒ…ï¼Œä½ å–œæ¬¢æŠŠä¼´ä¾£å½“ä½œå­©å­ä¸€æ ·å® çˆ±ã€ç®¡æ•™å’Œä¿æŠ¤ (Daddy/Mommy Dom)ã€‚' },
                'masochism': { t: 'å—è™è€… (M)', d: 'ç–¼ç—›å¯¹ä½ è€Œè¨€ä¸ä»…ä»…æ˜¯ç—›è§‰ï¼Œæ›´æ˜¯é€šå¾€æä¹ä¸–ç•Œçš„é’¥åŒ™ï¼Œè®©ä½ æ„Ÿå—åˆ°çœŸå®çš„å­˜åœ¨ã€‚' },
                'humiliation_m': { t: 'å—è¾±å€¾å‘', d: 'è¢«å‰¥å¤ºå°Šä¸¥çš„ç¬é—´ï¼Œåè€Œè®©ä½ å¸ä¸‹äº†å¹³æ—¥çš„ä¼ªè£…ï¼Œè·å¾—äº†çµé­‚çš„è§£è„±ã€‚' },
                'submission': { t: 'è‡£æœè€…', d: 'ä½ æ¸´æœ›å°†èº«å¿ƒå®Œå…¨æ‰˜ä»˜ç»™ä¸€ä½å¼ºå¤§çš„ä¸»å¯¼è€…ï¼Œåœ¨è‡£æœä¸­è·å¾—æœ€å¤§çš„å®‰å…¨æ„Ÿã€‚' },
                'obedience': { t: 'æœä»è€…', d: 'æ‰§è¡Œå‘½ä»¤æ˜¯ä½ è¡¨è¾¾çˆ±æ„çš„æ–¹å¼ï¼Œä¸¥æ ¼çš„è§„åˆ™åè€Œè®©ä½ æ„Ÿåˆ°å†…å¿ƒå¹³é™ã€‚' },
                'force_m': { t: 'å¼ºè¿«å¹»æƒ³', d: 'ä½ æ½œæ„è¯†é‡Œæ¸´æœ›ä¸å¯æŠ—åŠ›å¸¦æ¥çš„å†²å‡»ï¼Œè¿™èƒ½è®©ä½ åˆç†åŒ–å†…å¿ƒæ·±å¤„çš„æ¬²æœ›ã€‚' },
                'rebel': { t: 'å›é€†è€…', d: 'å¸¸è§„è®©ä½ åŒå€¦ï¼Œè¶Šæ˜¯è¢«ç¦æ­¢çš„é¢†åŸŸï¼Œè¶Šèƒ½ç‚¹ç‡ƒä½ çš„æ¿€æƒ…ã€‚' },
                'indulge': { t: 'çºµæ¬²è€…', d: 'ä½ è¿½æ±‚çº¯ç²¹çš„æ„Ÿå®˜äº«ä¹ï¼Œåœ¨æ€§çˆ±ä¸­å¸Œæœ›æŠ›å¼ƒç¤¾ä¼šèº«ä»½ï¼Œå›å½’æœ¬èƒ½ã€‚' },
                'exhibit': { t: 'éœ²å‡ºå€¾å‘', d: 'è¢«è§‚çœ‹çš„é£é™©è®©ä½ å¿ƒè·³åŠ é€Ÿï¼Œä¸–ç•Œçš„ç›®å…‰æ˜¯ä½ æœ€å¥½çš„å‚¬æƒ…å‰‚ã€‚' },
                'group': { t: 'ç¾¤ä½“ç©å®¶', d: 'ä¸€å¯¹ä¸€çš„å…³ç³»æ— æ³•æ»¡è¶³ä½ çš„æ¢ç´¢æ¬²ï¼Œä½ å–œæ¬¢æ›´å¤æ‚ã€æ›´çƒ­é—¹çš„äº’åŠ¨ã€‚' },
                'trans': { t: 'è·¨æ€§åˆ«å¹»æƒ³', d: 'ä½ å¯¹æ€§åˆ«çš„è¾¹ç•Œæ„Ÿåˆ°å¥½å¥‡ï¼Œå–œæ¬¢å°è¯•æ‰“ç ´ä¼ ç»Ÿæ€§åˆ«è§’è‰²çš„æ‰®æ¼”ã€‚' },
                'gay': { t: 'åŒå‘æ½œè´¨', d: 'ä½ çš„æ€§å–å‘å…·æœ‰æµåŠ¨æ€§ï¼Œå¯¹äºåŒæ€§ä¹‹é—´çš„ç¾æ„Ÿå’Œå¼ åŠ›æœ‰ç€æ•é”çš„æ„ŸçŸ¥ã€‚' },
                'fetish': { t: 'æ‹ç‰©é‰´èµå®¶', d: 'ç‰¹å®šçš„ç‰©å“ï¼ˆå¦‚ä¸è¢œã€çš®é©ã€è¶³ï¼‰ä¸ä»…æ˜¯é“å…·ï¼Œæ›´æ˜¯ä½ æ¬²æœ›çš„å¼€å…³ã€‚' },
                'ntr': { t: 'NTRçˆ±å¥½è€…', d: 'çœ‹ç€ä¼´ä¾£è¢«ä»–äººå æœ‰ï¼Œé‚£ç§å«‰å¦’ä¸å…´å¥‹äº¤ç»‡çš„å¤æ‚æƒ…ç»ªè®©ä½ æ¬²ç½¢ä¸èƒ½ã€‚' },
                'pure': { t: 'çº¯çˆ±æˆ˜ç¥', d: 'åœ¨ä½ çœ¼ä¸­ï¼Œèº«ä½“çš„ç»“åˆå¿…é¡»æ˜¯çµé­‚å…±é¸£çš„å»¶ä¼¸ï¼Œçˆ±æ˜¯æ€§çš„å”¯ä¸€ç†ç”±ã€‚' },
                'guide': { t: 'å¼•å¯¼è€…', d: 'ä½ å–œæ¬¢åƒå¯¼å¸ˆä¸€æ ·ï¼Œå¾ªå¾ªå–„è¯±åœ°å¼€å‘ä¼´ä¾£ï¼Œäº«å—å¯¹æ–¹ä¸€ç‚¹ç‚¹æˆé•¿çš„è¿‡ç¨‹ã€‚' },
                'mood': { t: 'æµªæ¼«ä¸»ä¹‰', d: 'ä½ æ³¨é‡æ°›å›´æ„Ÿï¼Œç¯å…‰ã€æ°”å‘³ã€éŸ³ä¹çš„é…åˆèƒ½è®©ä½ çš„ä½“éªŒæå‡åˆ°æ–°çš„é«˜åº¦ã€‚' }
            };

            let info = resultMap[top1Key] || { t: 'å¤šå…ƒæ¢ç´¢è€…', d: 'ä½ çš„æ€§åå¥½éå¸¸ä¸°å¯Œä¸”å‡è¡¡ï¼Œä¸è¢«å•ä¸€çš„æ ‡ç­¾æ‰€å®šä¹‰ã€‚' };
            finalTitle = info.t;
            finalDesc = info.d;

            // C. ç”Ÿæˆå‰¯æ ‡ç­¾ (ç¬¬2ã€3å)
            // è¾…åŠ©å‡½æ•°ï¼šé€šè¿‡keyæ‰¾ä¸­æ–‡å
            const getLabel = (k) => {
                let idx = dimKeys.indexOf(k);
                return idx !== -1 ? dimLabels[idx] : k;
            };

            // å¦‚æœç¬¬2ååˆ†æ•°ä¸é”™(>=2)ï¼ŒåŠ è¿›å»
            if (sortedScores[1] && sortedScores[1].score >= 2) {
                subTagsHTML += `<span class="sub-tag">#${getLabel(sortedScores[1].key)}</span>`;
            }
            // å¦‚æœç¬¬3ååˆ†æ•°ä¸é”™(>=2)ï¼ŒåŠ è¿›å»
            if (sortedScores[2] && sortedScores[2].score >= 2) {
                subTagsHTML += `<span class="sub-tag">#${getLabel(sortedScores[2].key)}</span>`;
            }
        }

        // æ¸²æŸ“æ–‡å­—
        document.getElementById('core-attr').innerText = finalTitle;
        document.getElementById('result-text').innerText = finalDesc;
        document.getElementById('sub-tags').innerHTML = subTagsHTML;

        // æ¸²æŸ“å›¾è¡¨
        renderChart();
    }

    // --- 4. ç»˜åˆ¶é›·è¾¾å›¾ ---
    function renderChart() {
        const ctx = document.getElementById('radarChart').getContext('2d');
        const dataValues = dimKeys.map(k => scores[k]);

        // è‡ªå®šä¹‰æ’ä»¶ï¼šç”»ä¸­å¿ƒé»„ç‚¹
        const centerDotPlugin = {
            id: 'centerDot',
            afterDraw: (chart) => {
                const { ctx, chartArea: { width, height } } = chart;
                const centerX = width / 2;
                const centerY = height / 2;
                ctx.save();
                ctx.beginPath();
                ctx.arc(centerX, centerY, 5, 0, 2 * Math.PI);
                ctx.fillStyle = '#f5a623'; // é»„è‰²ä¸­å¿ƒç‚¹
                ctx.fill();
                ctx.restore();
            }
        };

        if(window.myRadar) window.myRadar.destroy();

        window.myRadar = new Chart(ctx, {
            type: 'radar',
            plugins: [centerDotPlugin],
            data: {
                labels: dimLabels,
                datasets: [{
                    data: dataValues,
                    backgroundColor: 'rgba(91, 143, 249, 0.25)', // å¡«å……è“
                    borderColor: '#5b8ff9', // è¾¹æ¡†è“
                    borderWidth: 2,
                    pointBackgroundColor: '#5b8ff9',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 1.5,
                    pointRadius: 3
                }]
            },
            options: {
                maintainAspectRatio: false,
                scales: {
                    r: {
                        angleLines: { color: '#e0e0e0' },
                        grid: { 
                            circular: false, // å¤šè¾¹å½¢ç½‘æ ¼
                            color: '#e0e0e0' 
                        },
                        pointLabels: {
                            font: { size: 10, family: 'PingFang SC' },
                            color: '#666'
                        },
                        ticks: { display: false, maxTicksLimit: 6 },
                        suggestedMin: 0,
                        suggestedMax: 5
                    }
                },
                plugins: { legend: { display: false } }
            }
        });
    }
</script>

</body>
</html>